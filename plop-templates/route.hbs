import { {{modelCamel}}Controller } from './{{modelLower}}.controller.js'
import { baseRouter } from 'src/routes'
import { authenticate, authorize } from 'src/middleware'
import { z } from 'zod'

const {{modelName}}CreateSchema = z.object({
	// TODO: Defina os campos obrigatórios para criação
	// Exemplo:
	// name: z.string().min(1, 'Nome é obrigatório'),
	// description: z.string().optional(),
})

const {{modelName}}UpdateSchema = z.object({
	// TODO: Defina os campos opcionais para atualização
	// Exemplo:
	// name: z.string().min(1, 'Nome é obrigatório').optional(),
	// description: z.string().optional(),
})

export function {{modelCamel}}Routes(fastify) {
	const controller = {{modelCamel}}Controller()

	const listMiddleware = [authenticate]
	const createMiddleware = [authenticate, authorize('{{modelPlural}}:create')]
	const updateMiddleware = [authenticate, authorize('{{modelPlural}}:update')]
	const deleteMiddleware = [authenticate, authorize('{{modelPlural}}:delete')]

	baseRouter(fastify, controller, {
		tag: '{{resourceName}}',
		summary: 'Gerenciamento de {{resourceName}}',
		entityName: '{{resourceName}}',
		listMiddleware: listMiddleware,
		getMiddleware: listMiddleware,
		postMiddleware: createMiddleware,
		putMiddleware: updateMiddleware,
		deleteMiddleware: deleteMiddleware,
		schemas: {
			createSchema: {{modelName}}CreateSchema,
			updateSchema: {{modelName}}UpdateSchema,
			entitySchema: z.any()
		}
	})

	// TODO: Adicione rotas customizadas aqui se necessário
	// Exemplo:
	// fastify.route({
	//   method: 'POST',
	//   url: '/custom',
	//   preHandler: createMiddleware,
	//   handler: controller.customMethod
	// })
}
